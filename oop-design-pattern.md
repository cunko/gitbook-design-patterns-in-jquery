设计模式与面向对象
===============

学习设计模式的难点
---------------

很多人都想学习设计模式，但真正学会的并不多，能够把它用在工作当中改进代码质量的就更少了。学习设计模式的主要难点有四：

第一，它不是基本语法，学习之后也未必能立刻开始使用。设计模式都有适用的场景，非使用场景强行使用设计模式，只会事倍功半。所以开发人员需要比较丰富的编程经验、见过足够多的需求，才能自如的使用模式。

第二，比起一般的面向过程的代码，设计模式抽象层级更高，需要花费更多的心思去理解。

第三，设计模式关乎的是能不能写得好程序，而不是写不写得出。并非所有人都愿意花时间琢磨怎么样才把程序写得更好。

> 换言之，如果你喜丧提高自己的业务水平，投入时间学习，比如，你正在认真阅读这篇文章，恭喜你，你已经强过很多人了。

第四，请注意，《设计模式》一书的完整标题是：“设计模式——可复用面向对象软件的基础”。设计模式针对的是面向对象编程，不是面向过程编程，所以如果开发者不具备面向对象的思想，未能以对象为核心来架构代码，那么几乎不可能用得上设计模式。

所以归根结底，我们还是要从面向对象说起。

面向对象
--------

考虑到有些同学可能不熟悉面向对象编程（简称 OOP），所以这里简单介绍一下面向对象的思维方式。

面向对象是软件设计的一种抽象方式，它与面向过程的不同，后者把程序当成一系列指令的组合，面向对象则认为，程序就是“一些东西一起来完成一项工作”。这里的“东西”，就是面向对象中的“对象”，它们都有特定的职责，能完成特定的功能。我们根据需要自己的设计，拆分功能，形成若干对象，然后交代这些对象来完成特定工作。

举个例子。比如说我们要开发公司内部使用的 HR 工具，给所有同事算工资。

如果以面向过程的方式来写，那么它大概是这样的：

1. 取出所有同事的信息。
2. 取出所有同事的考勤。
3. 取出所有同事的绩效打分。
4. 取出所有的事假、病假、年假，借款报销抵扣之类的东西。
5. 合并以上所有信息进行计算，算出每个人的工资，返回用户。

看起来很简单，对吧？面向过程的代码在刚刚写出来的时候，通常符合逻辑、结构清晰、简单易懂。所以大部分同学一开始写的都是面向过程的代码，并且觉得自己写的还不错，既满足了需求，阅读起来也很轻松；如果更努力一些，在各个步骤当中加进去一些注释，简直就是非常好的代码了。

但是很快需求就产生了变化：

1. 首先，大家的工资并不是每个月都一样，比如过年的时候，通常都会发年终奖；天热的时候，公司也可能给大家发一些降温费。
2. 公司的业务出现了变化，有一部分同事的底薪下调，绩效比重增加。
3. 不同岗位对到岗时间要求不一样，销售要拜访客户，其它部门都要准点上下班
4. 除了纵向的岗位工资，还有横向的项目奖金，即使同属一个部门，大家的各种系数也不一样
5. ……

随着需求变化，代码不断调整，越来越臃肿。我们不得不加入各种 `if ... else ...`，代码行数不断增加，甚至上涨到几千行。此时的代码几乎不能维护，因为你根本不知道这里的一处改动会对后面造成什么样的影响。

有时候我们会尝试重构，加入一些函数，但基本无济于事，战略问题无法通过战术来弥补。

### 面向对象的解法

这样还是刚才这个需求，如果是面向对象的话，我们第 1 步当然还是要取出所有员工的集合，但接下来就不太一样了。

我们可能会调用考勤数据打分等数据，然后导入这个集合，也可以用这个集合来取，用这个集合里面的每个员工，来去取他们所每个月他们自己所需要的每个数据。

然后这些数据，会再去进行加权和修正。

不同岗位的员工在计算各自工资的时候，会带入不同的公式，那么在面向对象的里边就会用超类和子类来实现。

之类的方法，会覆盖父类的方法，这样我们就可以实现，我们就可以相同的函数名实现不同的计算方式。

这个时候，如果某个岗位的员工的计算方式进行了变化，我们只要找到特定的滋味，对其中的某一个特定的函数进行简单的修改就可以了，改造难度大大降低。

这就是面向对象编程，从短期来看，在最开始写代码的时候，它的逻辑和我们直接去思考一个过程的逻辑，不完全一样。

需要我们花费更多的时间去进行逻辑上面的修正和整合。

从短期来看，从面向过程到面向对象，使用的时间会增加。

但是长期来看，因为程序设计逻辑的，简单清晰明了。

代码之间的结果

代码复用的增加，所以面向对象从长期来看，它的维护效率和二次开发的效率远远高于面向过程编程。

大多数项目大多数需求而言，使用面向对象是节省开发时间的。

设计模式则是大家在大爱面前使用了，在大量使用面向对象开发之后，总结出来的一些能够进一步改善代码结构，改进，维护效率的方式方法。

理解和学会设计模式，对我们之后开发，会有很大的帮助。

有些同学可能还没有使用过设计模式，但实际上在我们外部前端的开发当中，设计模式的地位非常显著。

除了本文将讲述的这几个设计模式之外，还有观察者模式，也就是我们外部当中非常常见的事件机制。

既然是理原型链，其实也是设计模式的一种。

如果您使用过三代 MV m 框架，那么你应该也用过其中的数据状态管理工具，比如 vivo x 。

他则是一个非常经典的中介模式的变化。

所以实际上在我们日常当中就已经在享受设计模式带来的便利性，高效率了。

设计模式在确立之初，大约有 23 种被分为三大类。

但是大家需要注意的是时过境迁，我们现在的开发环境，与那个时候的开发环境其实已经出现了很大的变化，我们的语言和那个时候的语言，无论在 API 设计上，在语法设计上，在抽象程度上，都有非常不一样的地方。

比如圆形电视机 s 的基本设计结构之一。

所以大家在学习设计模式的时候，也千万要与时俱进。

不要盲目的去照搬一些书上的设计，或者书上的示范代码。

比如单例模式，在大多数的讲设计模式的书里面，都会教你怎么样去声明一个类，然后怎么样去，声明一个它的静态方法，然后怎么样用这个静态方法去构建一个实例，之后在所有的地方都返回这个实例，这就叫单例模式了。

但是我们用的是 gs gs 的，使用场景完全不同，而且我们有 WiFi 之类的打包工具，所以我们可以直接返回一个对象，就是当地的利，就是单立忠的实力。

这个实力可以干所有我们想让他干的事情，而我们也不需要去考虑它是什么时间，声明啊，因为我们完全可以用 WiFi 太卡， yes modelslike 取出它，使用它。

第二，我也不认为大家需要把一次性把所有的设计模式都学完，除了当初的经典的设计模式之后，大家又相继提出了一些新的设计模式，比如 promise ，我认为也算是一种设计模式，它解决的是靠 back 回到地域的问题。

这设计模式往往都是针对某些特定的场景而已，而总结出总结归纳出来的，脱离那个场景你可能很难理解为什么要这样去做。

好像背单词你找了一本生物命名书，背了一大本的生物的拉丁名词，但实际上你的生活当中几乎完全用不到它，那么你就会慢慢把它淡忘掉，那么你。

我以为正确的用法应该是先简单阅读一遍，这些设计模式，他们为了解决什么样子的场景？

但当你遇见这个场景的时候，你就会想要，是不是那个设计模式可以派上一些用场，然后你再回去看那个设计模式，解决的问题，具体是不是和这个场景类似？

然后他是怎么做的？他有哪些注意事项？然后你再按这个来做。

是重复大概两三次，这个设计模式就会牢牢的印在你的脑海里。

比如最常见的，我们用策略模式或者状态模式去解决一些不同属性，去解决一些类似于刚才所说的，不同岗位的员工工资计算问题的时候。

你稍微处理几个这样类似的，需求就会非常清楚的记得，状态模式和策略模式，是怎么用的呢？

如果有一个设计模式你了解了，但是你今后的好几年都没有用到也没关系，那很可能说明你，在你的业务当中，或者说在你面临的这个，开发工具开发体系，用户群体当中，是不太需要这个设计模式的。

比如说圆形电模式，除了在 PS 当中使用圆形链之外，我们几乎不用了解任何原型链的实现。

这是好的，也是对的，就像我们不用考虑怎么样去，写一个 js 出来一样。

OK 关于面向对象和设计模式，我要说的大概就说完了，接下来我们来看第 1 个设计模式。

享元模式

好新闻之词，这块儿当中使用过的设计模式大概都跟大家介绍了，怎么样？它的确是我们使用这款锐的重要帮助手段。

咱也没错吧

希望大家在今后的工作实践当中能够找到机会，运用这些设计模式。

最后再总结一下前面说过的那种东西。

1 ，不要刻板的用书上的方式来使用设计模式。

2 ，找个机会把所有的设计模式看一遍，并且在生产当中，能用到的尽量去用。

三，发现设计模式，使用设计模式，从别人的代码当中，学习使用设计模式。

谢谢大家，接下来的时间欢迎大家与我进行沟通，如果你在，今后看到了这篇文章，也随时欢迎通过各种途径来跟我沟通，如果你在使用，在开发当中遇见了非常好的设设计模式的场景，也欢迎你与我进行分享。
